<!-- CSS -->
<link href="/devwidgets/newprofilesection/css/newprofilesection.css" type="text/css" />

<!-- GENERAL INFO -->
<div id="newprofilesection_container">
    <div id="newprofilesection_header"></div>
    <div id="newprofilesection_body"></div>
</div>

<div id="newprofilesection_header_template" style="display:none"><!--
    <div class="s3d-contentpage-title">${section.label}</div>
--></div>

<div id="newprofilesection_edit_template" style="display:none"><!--
    {macro renderTextInput(config, field_id, data)}
        <input type="text" id="${field_id}" name="${field_id}" {if data && data.value}value="${data.value}"{/if}{if config.required} class="required"{/if}/>
    {/macro}

    {macro renderTextarea(config, field_id, data)}
        <textarea id="${field_id}" name="${field_id}" {if config.required} class="required"{/if}>{if data && data.value}${data.value}{/if}</textarea>
    {/macro}

    {macro renderDropdown(config, field_id, data)}
        <select id="${field_id}" name="${field_id}" {if config.required} class="required"{/if}>
            <option value=""></option>
        {for option in config.select_elements}
            <option value="${option_index}"{if data && data.value === option_index} selected="selected"{/if}>${option}</option>
        {/for}
        </select>
    {/macro}

    {macro renderMultiSelect(config, field_id, data, form_group)}

    {/macro}

    {var form_group = unique ? "form_group_" + unique : section.id}

    {if !section.multiple}
    <form id="newprofilesection_form_${sectionid}">
    {else}
    <div id="${form_group}" class="newprofilesection_multiple_section">
    <input type="hidden" name="order_${unique}" value="${order}" />
    {/if}
        <div class="s3d-form-field-wrapper">
        {for field in section.elements}
            {if field.display}
                {var field_data = data && data[ field_index ] ? data[ field_index ] : false}
                {var field_id = unique ? field_index + "_" + unique : field_index}
                <div class="newprofilesection_field">
                    <label for="${field_id}" class="s3d-input-label">${field.label}:</label>
                    {if field.type === "select"}
                        ${renderDropdown(field, field_id, field_data)}
                    {elseif field.type === "textarea"}
                        ${renderTextarea(field, field_id, field_data)}
                    {else}
                        ${renderTextInput(field, field_id, field_data)}
                    {/if}
                    {if field.example}
                        <p class="newprofilesection_generalinfo_example">${field.example}</p>
                    {/if}
                </div>
            {/if}
        {/for}
        </div>
    {if !section.multiple}
        <button type="submit" class="s3d-button s3d-overlay-button grey profile-section-save-button">__MSG__UPDATE__</button>
    </form>
    {else}
        <button type="button" class="newprofilesection_remove_section s3d-bold s3d-link-button" id="newprofilesection_remove_link_${unique}"><span>__MSG__REMOVE_THIS__ ${section.multipleLabel}</span></button>
        <hr/>
    </div>
    {/if}
--></div>

<div id="newprofilesection_edit_multiple_template"><!--
    <form id="newprofilesection_form_${sectionid}">
        <div id="newprofilesection_sections_${sectionid}" class="newprofilesection_multiple_sections"></div>
        <button type="submit" class="s3d-button s3d-overlay-button grey profile-section-save-button" style="display:none">__MSG__UPDATE__</button>
    </form>
    <button id="newprofilesection_add_${sectionid}" class="newprofilesection_add_section s3d-link-button s3d-bold" type="button"><span class="s3d-add_another_location"></span><span>__MSG__ADD_ANOTHER__ ${section.multipleLabel}</span></button>
--></div>

<div id="newprofilesection_view_multiple_template"><!--
    <div id="newprofilesection_sections_${sectionid}" class="newprofilesection_multiple_sections"></div>
--></div>

<div id="newprofilesection_view_no_results_template" style="display:none"><!--
    <div class="s3d-no-results-container">
        <div class="s3d-no-results-arrow-up"></div>
        <div class="s3d-no-results-icon s3d-no-results-contacts"></div>
        <h1>
            <span id="newprofilesection_no_results_text" style="display:none">__MSG__THIS_PERSON_HASNT_ADDED_SECTION_YET__</span>
            <span id="newprofilesection_no_results_message" style="display:none;">
                <button type="button" id="newprofilesection_user_message" class="s3d-link-button sakai_sendmessage_overlay" data-sakai-entityid="${userid}" data-sakai-entityname="${displayName}" data-sakai-entitytype="user">__MSG__SEND_THEM_A_MESSAGE__</button> __MSG__TO_REMIND_THEM__
            </span>
        </h1>
    </div>
--></div>

<div id="newprofilesection_view_template" style="display:none"><!--
    {macro renderField(config, field_id, field_data)}
        {var value = config.type === "select" ? sakai.api.i18n.General.process(config.select_elements[field_data.value]) : field_data.value}
        <span class="field_value">${value}</span>
    {/macro}
    {for field in section.elements}
        {if field.display}
            {var field_data = data && data[ field_index ] ? data[ field_index ] : false}
            {if field_data}
            <div class="newprofilesection_field">
                <span class="s3d-input-label">${field.label}:</span>
                ${renderField(field, field_index, field_data)}
            </div>
            {/if}
        {/if}
    {/for}
    {if section.multiple}
    <hr/>
    {/if}
--></div>


<!-- ERROR CONTAINER -->
<div id="profile_error" style="display:none;">
    <div id="profile_error_form_errors">__MSG__SOME_FIELDS_CONTAIN_ERRORS_PLEASE_CHECK_AGAIN__</div>
    <div id="profile_error_form_error_server">__MSG__THERE_WAS_AN_ERROR_TRYING_TO_SAVE_YOUR_DATA_ON_THE_SERVER__. __MSG__PLEASE_TRY_AGAIN_LATER_OR_CALL_HELPDESK__.</div>
    <div id="profile_message_form_successful">__MSG__YOUR_PROFILE_INFORMATION_HAS_BEEN_UPDATED__</div>
</div>

<!-- JAVASCRIPT -->
<script src="/devwidgets/newprofilesection/javascript/newprofilesection.js" type="application/javascript"></script>
