<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" class="fl-layout-">
    <head>

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>__MSG__WIDGET_PLAYGROUND__ - Embed Content</title>

        <!-- Sakai Core CSS -->
        <link rel="stylesheet" type="text/css" href="/dev/css/FSS/fss-base.css" />
        <link rel="stylesheet" type="text/css" href="/dev/css/sakai/sakai.base.css" />
        <link rel="stylesheet" type="text/css" href="/dev/css/sakai/sakai.core.2.css" />
        <link rel="stylesheet" type="text/css" href="/dev/css/sakai/sakai.3.css" />

        <!-- Sakai Page CSS -->
        <!-- <link rel="stylesheet" type="text/css" href="/dev/css/sakai/sakai.group.css" /> -->
        <link rel="stylesheet" type="text/css" href="/dev/css/sakai/sakai.show.css" />

        <!-- 3rd party CSS -->
        <link rel="stylesheet" type="text/css" href="/dev/css/sakai/sakai.treeview.css" />
        <link rel="stylesheet" type="text/css" href="/dev/css/sakai/sakai.components.jq_pager.css" />
        <link rel="stylesheet" type="text/css" href="/dev/lib/jquery/plugins/gritter/css/jquery.gritter.css" />
        <link rel="stylesheet" type="text/css" href="/dev/lib/jquery/plugins/imgareaselect/imgareaselect-default.css" />
        <link rel="stylesheet" type="text/css" href="/dev/css/lib/jquery.autoSuggest.css" />

        <!-- Sakai Config JS -->
        <script type="text/javascript" src="/dev/configuration/widgets.js"></script>
        <script type="text/javascript" src="/var/widgets.json?callback=sakai.storeWidgets"></script>
        <script type="text/javascript" src="/dev/configuration/config.js"></script>
        <script type="text/javascript" src="/dev/configuration/config_custom.js"></script>

        <!-- Core 3rd-party JS -->
        <script type="text/javascript" src="/dev/lib/jquery/jquery.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/jquery-ui.full.js"></script>
        <script type="text/javascript" src="/dev/lib/fluid/3akai_Infusion.js"></script>
        <script type="text/javascript" src="/dev/lib/misc/l10n/globalization.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.json.js"></script>
        <script type="text/javascript" src="/dev/lib/misc/google/html-sanitizer-minified.js"></script>

        <!-- Sakai Core JS -->
        <script type="text/javascript" src="/dev/lib/sakai/sakai.api.core.js"></script>
        <script type="text/javascript" src="/dev/lib/sakai/sakai.api.util.js"></script>
        <script type="text/javascript" src="/dev/lib/sakai/sakai.api.i18n.js"></script>
        <script type="text/javascript" src="/dev/lib/sakai/sakai.api.l10n.js"></script>
        <script type="text/javascript" src="/dev/lib/sakai/sakai.api.user.js"></script>
        <script type="text/javascript" src="/dev/lib/sakai/sakai.api.widgets.js"></script>
        <script type="text/javascript" src="/dev/lib/sakai/sakai.api.groups.js"></script>
        <script type="text/javascript" src="/dev/lib/sakai/sakai.api.communication.js"></script>
        <script type="text/javascript" src="/dev/lib/sakai/sakai.api.content.js"></script>

        <!-- 3rd party JS -->
        <script type="text/javascript" src="/dev/lib/misc/trimpath.template.js"></script>
        <script type="text/javascript" src="/dev/lib/misc/querystring.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jqmodal.sakai-edited.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.cookie.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.pager.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.ba-bbq.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.threedots.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jsTree/jquery.jstree.sakai-edit.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jqScrollPane.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.autoSuggest.sakai-edited.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/gritter/jquery.gritter.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.form.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.MultiFile.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.jeditable.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/jquery.validate.sakai-edited.js"></script>
        <script type="text/javascript" src="/dev/lib/jquery/plugins/imgareaselect/jquery.imgareaselect.js"></script>
        <script type="text/javascript" src="/dev/lib/tinymce/tiny_mce.js"></script>
        <script src="/tests/qunit/js/jquery.mockjax.js"></script>

    </head>

    <body class="fl-centered profile_preview i18nable">

        <!-- HEADER -->
        <div class="fl-container-flex header">
            <div class="fl-fix fl-centered fixed-container">
                <div class="decor"></div>

                <!-- TITLE BAR  -->
                <div class="s3d-site-heading fl-force-left">
                    <h1 id="sitetitle">__MSG__WIDGET_PLAYGROUND__ - Site</h1>
                </div>
            </div>
        </div>

        <!-- CONTENT -->
        <div class="fl-centered fixed-container" style="background: #fff; min-height: 400px;">
            <a href="#" id="add_page">Add Page</a><br/>
            <!--a href="#" id="delete_page">Delete Page</a><br/-->
            <div id="widget_site_site-uuid" class="widget_inline"></div>
            
        </div>

        <!-- FOOTER WIDGET -->
        <div id="widget_footer" class="widget_inline footercontainer"></div>

        <script>
            $.mockjax({
                url: "/var/services/gimmeSiteData.json",
                response: function(settings) {
                    this.responseText = {
                        "sling:resourceType":"sakai/site",
                        "jcr:uuid": settings.data,
                        "total": 3, 
                        "pages": 
                        [
                            {
                                "jcr:uuid": "some-uuid",
                                "sakai:pageTitle": "My Page",
                                "sakai:pagePosition": 0,
                                "sakai:deletable": "true",
                                "children": 
                                [
                                    {
                                        "jcr:uuid": "child-uuid",
                                        "sakai:pageTitle": "Child Page",
                                        "sakai:pagePosition": 0
                                    }
                                ]
                            },
                            {
                                "jcr:uuid": "another-uuid",
                                "sakai:pageTitle": "My Second Page",
                                "sakai:pagePosition": 1
                            }
                        ]
                    };
                    
                } 
            });

            $.mockjax({
                url: "/var/services/getPageData.json",
                response: function(settings) {
                    this.responseText = {
                        "sling:resourceType":"sakai/page",
                        "jcr:uuid": settings.data,
                        "sakai:pageContent": "<p>html <i>string</i> of page content"  + Math.ceil(Math.random() * 1000) + "</p>",
                        "sakai:pageTitle": "Page Title " + Math.ceil(Math.random() * 1000),
                        "sakai:pageDescription": "Page Description " + Math.ceil(Math.random() * 1000)
                    };
                }
            });

            // Page code
            $(window).bind("sakai.site.site-uuid.ready", function(e){
                $(window).trigger("sakai.site.site-uuid.load");
            });

            $("#add_page").live("click", function() {
                var pageObj = {};
                var rand = Math.ceil(Math.random() * 10000);
                pageObj["jcr:uuid"] = "child-page-" + rand;
                pageObj["sakai:pageTitle"] = "Child Page " + rand;
                $(window).trigger("sakai.sitenavigation.addPage.nav-site-uuid", pageObj);
                return false;
            });
            $("#delete_page").live("click", function() {
                $(window).trigger("sakai.sitenavigation.deletePage.nav-site-uuid");
                return false;
            });
        </script>

    </body>

</html>
